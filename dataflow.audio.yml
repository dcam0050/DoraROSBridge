nodes:
  - id: gstreamer-audio-receiver
    build: cargo build -p gstreamer-audio-receiver
    path: target/debug/gstreamer-audio-receiver
    inputs:
      tick: dora/timer/millis/10
    env:
      AUDIO_UDP_PORT: "5004"
      AUDIO_SAMPLE_RATE: "48000"
      AUDIO_CHANNELS: "1"
      AUDIO_FORMAT: "S16LE"
      # OpenTelemetry environment variables
      OTEL_SERVICE_NAME: "gstreamer-audio-receiver"
      OTEL_RESOURCE_ATTRIBUTES: "service.name=gstreamer-audio-receiver"
    outputs:
      - audio

  - id: ros2-audio-publisher
    build: cargo build -p ros2-audio-publisher
    path: target/debug/ros2-audio-publisher
    inputs:
      audio: gstreamer-audio-receiver/audio
    env:
      ROS2_AUDIO_TOPIC: "/audio"
      # OpenTelemetry environment variables
      OTEL_SERVICE_NAME: "ros2-audio-publisher"
      OTEL_RESOURCE_ATTRIBUTES: "service.name=ros2-audio-publisher"
